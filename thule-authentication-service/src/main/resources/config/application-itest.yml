# Spring actuator configuration
info:
  description: Thule Test Service
  name: ${spring.application.name}

# Spring boot configuration
spring:
  application:
    name: thule-test-service
  cloud:
    loadbalancer:
      ribbon:
        enabled: false
  main:
    web-application-type: SERVLET
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${thule.keycloak.base-url}/auth/realms/${thule.keycloak.realm}

# Thule configuration
thule:
  keycloak:
    base-url: http://localhost # Will be replaced dynamically at runtime with keycloak containers ip address and port
    realm: thule-test

######################################### NESTED INTEGRATION TEST PROFILES #######################################
---
spring:
  profiles: itest-feign
  cloud:
    discovery:
      client:
        simple:
          instances:
            thule-test-service:
              - uri: http://localhost:${server.port}
  security:
    oauth2:
      client:
        provider:
          keycloak:
            token-uri: ${thule.keycloak.base-url}/auth/realms/${thule.keycloak.realm}/protocol/openid-connect/token
        registration:
          keycloak:
            authorization-grant-type: client_credentials
            client-id: thule-test-service
            client-secret: client-secret # Will be replaced dynamically at runtime with the client secret obtained from keycloak

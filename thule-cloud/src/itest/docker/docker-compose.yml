version: "2"
services:
  ################################  thule-admin-server  ################################
  thule-admin-server:
    image: pooh.serin-consultancy.co.uk/thule-admin-server
    environment:
      THULE_CONFIG_SERVICE_HOST: thule-config-service-host
      THULE_DISCOVERY_SERVICE_HOST: thule-discovery-service-host
    extra_hosts:
      - docker-host:172.17.0.1
      - logstash-host:172.17.0.1
      - zipkin-host:172.17.0.1
    hostname: admin-server-1
    links:
      - thule-config-service:thule-config-service-host
      - thule-discovery-service:thule-discovery-service-host
    ports:
      - "9071:8071"
    volumes:
      # Set localtime and timezone on container to be the same as the host
      - /etc/localtime:/etc/localtime:ro
      - /etc/timezone:/etc/timezone:ro

  ################################  thule-config-service  ################################
  thule-config-service:
    image: pooh.serin-consultancy.co.uk/thule-config-service
    environment:
      THULE_DISCOVERY_SERVICE_HOST: docker-host
      THULE_DISCOVERY_SERVICE_PORT: 9761
    extra_hosts:
      - docker-host:172.17.0.1
      - logstash-host:172.17.0.1
      - zipkin-host:172.17.0.1
    hostname: config-service-1
    ports:
      - "9888:8888"
    volumes:
      # Set localtime and timezone on container to be the same as the host
      - /etc/localtime:/etc/localtime:ro
      - /etc/timezone:/etc/timezone:ro

  ################################  thule-discovery-service  ################################
  thule-discovery-service:
    image: pooh.serin-consultancy.co.uk/thule-discovery-service
    environment:
      THULE_CONFIG_SERVICE_HOST: docker-host
      THULE_CONFIG_SERVICE_PORT: 9888
    extra_hosts:
      - docker-host:172.17.0.1
      - logstash-host:172.17.0.1
      - zipkin-host:172.17.0.1
    hostname: discovery-service-1
    ports:
      - "9761:8761"
    volumes:
      # Set localtime and timezone on container to be the same as the host
      - /etc/localtime:/etc/localtime:ro
      - /etc/timezone:/etc/timezone:ro

  ################################  thule-edge-server  ################################
  thule-edge-server:
    image: pooh.serin-consultancy.co.uk/thule-edge-server
    environment:
      THULE_CONFIG_SERVICE_HOST: thule-config-service-host
      THULE_DISCOVERY_SERVICE_HOST: thule-discovery-service-host
    extra_hosts:
      - docker-host:172.17.0.1
      - logstash-host:172.17.0.1
      - zipkin-host:172.17.0.1
    hostname: edge-server-1
    links:
      - thule-config-service:thule-config-service-host
      - thule-discovery-service:thule-discovery-service-host
    ports:
      - "9080:8080"
    volumes:
      # Set localtime and timezone on container to be the same as the host
      - /etc/localtime:/etc/localtime:ro
      - /etc/timezone:/etc/timezone:ro

  ################################  thule-email-server  ################################
  thule-email-service:
    image: pooh.serin-consultancy.co.uk/thule-email-service
    environment:
      THULE_CONFIG_SERVICE_HOST: thule-config-service-host
      THULE_DISCOVERY_SERVICE_HOST: thule-discovery-service-host
    extra_hosts:
      - docker-host:172.17.0.1
      - logstash-host:172.17.0.1
      - zipkin-host:172.17.0.1
    hostname: email-server-1
    links:
      - thule-config-service:thule-config-service-host
      - thule-discovery-service:thule-discovery-service-host
    ports:
      - "9091:8091"
    volumes:
      # Set localtime and timezone on container to be the same as the host
      - /etc/localtime:/etc/localtime:ro
      - /etc/timezone:/etc/timezone:ro

  ################################  thule-people-service  ################################
  thule-people-service:
    image: pooh.serin-consultancy.co.uk/thule-people-service
    environment:
      THULE_CONFIG_SERVICE_HOST: thule-config-service-host
      THULE_DISCOVERY_SERVICE_HOST: thule-discovery-service-host
    extra_hosts:
      - docker-host:172.17.0.1
      - logstash-host:172.17.0.1
      - zipkin-host:172.17.0.1
    hostname: people-service-1
    links:
      - thule-config-service:thule-config-service-host
      - thule-discovery-service:thule-discovery-service-host
    ports:
      - "9090:8090"
    volumes:
      # Set localtime and timezone on container to be the same as the host
      - /etc/localtime:/etc/localtime:ro
      - /etc/timezone:/etc/timezone:ro
